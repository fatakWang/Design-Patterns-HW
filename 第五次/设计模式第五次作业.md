### 1. 外观模式

某软件公司为新开发的智能手机控制与管理软件提供了一键备份功能，通过该功能可以将原本存储在手机中的通讯录、短信、照片、歌曲等资料一次性全部拷贝到移动存储个质（例如 MMC 卡或 SD 卡）中。在实现过程中需要与多个已有的类进行交互，例如通讯录管理类、短信管理类等。为了降低系统的耦合度，试使用外观模式来设计并编程模拟实现该一键备份功能。

![image-20221026233407218](C:\Users\fatak\AppData\Roaming\Typora\typora-user-images\image-20221026233407218.png)

```java
package facade_moudle;

public class Facade {
    public void copy(){
        new message().copy();
        new music().copy();
        new addressBook().copy();
        new photo().copy();

    }
}
```

```java
package facade_moudle;

public class message {
    public void copy(){
        System.out.println("短信备份完成");
    }
}
```

```java
package facade_moudle;

public class music {
    public void copy(){
        System.out.println("音乐备份完成");
    }
}
```

```java
package facade_moudle;

public class photo {
    public void copy(){
        System.out.println("照片备份完成");
    }
}
```

```java
package facade_moudle;

public class addressBook {
    public void copy(){
        System.out.println("通讯录备份完成");
    }
}
```

```java
package facade_moudle;

public class Main {
    public static void main(String[] args) {
        new Facade().copy();
    }
}
```

运行main结果：

![image-20221026233813358](C:\Users\fatak\AppData\Roaming\Typora\typora-user-images\image-20221026233813358.png)

### 2. 中介者模式

为了大力发展旅游业，某城市构建了一个旅游综合信息系统，该系统包括旅行社子系统（travel companies Subsystem）、宾馆子系统（HotelsSubsystem）、餐厅于系统( Restaurants Subsystem )、机场子系统（Airport Subsystem）、旅游景点子系统（TourismAttractions Subsystem）等多个子系统，通过该旅游综合信息系统，各类企业之间可实现信息共享，一家企业可以将客户信息传递给其他合作伙伴。例如，当一家旅行社有一些客户后，该旅行社可以将客户信息传送到宾馆子系统、餐厅子系统、机场子系统和旅游景点子系统；宾馆也可以将顾客信息传送到旅行社子系统、餐子系统、机场子系统和旅游景点子系统；机场也可以将乘客信息传送到旅行社子系统、宾馆子系统、餐厅子系统和旅游景点子系统。由于这些子系统之间存在较为复杂的交互关系，现采用中介者模式为该旅游综合信息系统提供一个高层设计，绘制对应的类图并编程模拟实现

以旅行社子系统、宾馆子系统、机场子系统为例，这里假设这些子系统会share一段信息，这段信息会被分享到其他所有子系统，在本例只是将这段信息打印出来。

![image-20221027111613919](C:\Users\fatak\AppData\Roaming\Typora\typora-user-images\image-20221027111613919.png)

```java
package mediator_moudle;

public abstract class Mediator {
    public abstract void createColleague();
    public abstract void colleagueChanged(Colleague c,String info);
}
```

```java
package mediator_moudle;

public class ConcreteMediator extends Mediator{
    public Colleague travelSys;
    public Colleague hotelSys;
    public Colleague airportSys;

    @Override
    public void createColleague() {
        travelSys=new TravelColleague();
        hotelSys=new HotelColleague();
        airportSys=new AirportColleague();
        travelSys.setMediator(this);
        hotelSys.setMediator(this);
        airportSys.setMediator(this);
    }

    @Override
    public void colleagueChanged(Colleague c,String info) {
        if(c.equals(travelSys)){
            hotelSys.controlColleague(info);
            airportSys.controlColleague(info);
        }
        if(c.equals(hotelSys)){
            travelSys.controlColleague(info);
            airportSys.controlColleague(info);
        }
        if(c.equals(airportSys)){
            hotelSys.controlColleague(info);
            travelSys.controlColleague(info);
        }
    }
}
```

```java
package mediator_moudle;

public abstract class Colleague {
    protected Mediator mediator;
    public void setMediator(Mediator mediator){
        this.mediator=mediator;
    }
    public abstract void controlColleague(String info);

}
```

```java
package mediator_moudle;

public class HotelColleague extends Colleague{
    @Override
    public void controlColleague(String info) {
        System.out.println("酒店系统收到信息"+info);
    }

    public void share(String info){
        this.mediator.colleagueChanged(this,"来自酒店管理系统"+info);
    }
}
```

```java
package mediator_moudle;

public class TravelColleague extends Colleague{
    @Override
    public void controlColleague(String info) {
        System.out.println("旅游管理系统收到信息"+info);
    }
    public void share(String info){
        this.mediator.colleagueChanged(this,"来自旅游管理系统"+info);
    }
}
```

```java
package mediator_moudle;

public class AirportColleague extends Colleague{
    @Override
    public void controlColleague(String info) {
        System.out.println("机场管理系统收到信息"+info);
    }

    public void share(String info){
        this.mediator.colleagueChanged(this,"来自机场管理系统"+info);
    }
}
```

```java
package mediator_moudle;

public class Main {
    public static void main(String[] args) {
        ConcreteMediator m=new ConcreteMediator();
        m.createColleague();
        TravelColleague t=(TravelColleague)m.travelSys;
        t.share("123");
        System.out.println("---------------------");
        HotelColleague h=(HotelColleague)m.hotelSys;
        h.share("456");
        System.out.println("---------------------");
        AirportColleague a=(AirportColleague) m.airportSys;
        a.share("789");

    }


}
```

运行main结果

![image-20221027114428821](C:\Users\fatak\AppData\Roaming\Typora\typora-user-images\image-20221027114428821.png)



### 3. 观察者模式

某文字编辑软件须提供如下功能：在文本编辑窗口中包含一个可编辑文本区和3 个文本信息统计区，用户可以在可编辑文本区对文本进行编辑操作，第一个文本信息统计区用于显示可编辑文本区中出现的单词总数量和字符总数量，第二个文本信息统计区用于显示可编辑文本区中出现的单词（去重后按照字典序排序），第三个文本信息统计区用于按照出现频次降序显示可编辑文本区中出现的单词以及每个单词出现的次数（例如hello :5）。现采用观察者模式设计该功能，绘制对应的类图并编程模拟实现。

![image-20221027091138644](C:\Users\fatak\AppData\Roaming\Typora\typora-user-images\image-20221027091138644.png)



```java
package observer_moudle;

import java.util.ArrayList;
import java.util.Iterator;
import java.util.List;

public abstract class Editor {
    public List<Observer> observers=new ArrayList<Observer>();
    public void addObserver(Observer o){
        observers.add(o);
    }
    public void deleteObserver(Observer o){
        observers.remove(o);
    }
    public void notifyObservers(){
        Iterator it=observers.iterator();
        while(it.hasNext()){
            Observer o=(Observer) it.next();
            o.update(this);
        }
    }
    public abstract String getContent();
    public abstract void setContent(String str);
}
```

```java
package observer_moudle;

import java.util.ArrayList;
import java.util.Iterator;
import java.util.List;

public class ConcreteEditor extends Editor{
    String content;
    @Override
    public String getContent() {
        return content;
    }

    @Override
    public void setContent(String str) {
        this.content=str;
    }
}
```

```java
package observer_moudle;

public abstract class Observer {
    public abstract void update(Editor e);
}
```

```java
package observer_moudle;

public class Observer1 extends Observer{
    @Override
    public void update(Editor e) {
        System.out.println("文本信息统计区显示显示可编辑文本区中出现的单词总数量和字符总数量");
    }
}
```

```java
package observer_moudle;

public class Observer2 extends Observer{
    @Override
    public void update(Editor e) {
        System.out.println("显示可编辑文本区中出现的单词");
    }
}
```

```java
package observer_moudle;

public class Observer3 extends Observer{
    @Override
    public void update(Editor e) {
        System.out.println("按照出现频次降序显示可编辑文本区中出现的单词以及每个单词出现的次数");
    }
}
```

```
package observer_moudle;

public class Main {
    public static void main(String[] args) {
        Editor e=new ConcreteEditor();
        e.addObserver(new Observer1());
        e.addObserver(new Observer2());
        e.addObserver(new Observer3());

        e.setContent("123");
        e.notifyObservers();
        System.out.println("----------");
        e.setContent("asdf5");
        e.notifyObservers();
    }
}
```

运行main结果

![image-20221027092613470](C:\Users\fatak\AppData\Roaming\Typora\typora-user-images\image-20221027092613470.png)

### 4. 备忘录模式

某文字编辑软件须提供撤销（Undo）和重做／恢复（Redo）功能，并且该软件可支持 文档对象的多步撤销和重做。开发人员决定采用备忘录模式来实现该功能，在实现过程中引人栈（Stack）作为数据结构。在实现时，可以将备忘录对象保存在两个栈中，一个栈包含用于实现撤销操作的状态对象，另一个栈包含用于实现重做操作的状态对象。在实现撤销操作时，会弹出撤销栈栈顶对象以获取前一个状态并将其设置给应用程序；同样，在实现重做操作时，会弹出重做栈栈顶对象以获取下一个状态并将其设置给应用程序。绘制对应的类图并编程模拟实现。

![image-20221026201921050](C:\Users\fatak\AppData\Roaming\Typora\typora-user-images\image-20221026201921050.png)

```java
package menento_moudle;

public class Memento {
    private String content;
    Memento(String content){
        this.content=content;
    }
    String getContent(){
        return content;
    }
}
```

```java
package menento_moudle;


import visitor_moudle.ScaleVisitor;

import java.util.Scanner;
import java.util.Stack;

public class Main {
    public static void main(String[] args) {
        txt t=new txt();
        Memento m=t.createMemento();
        Scanner c=new Scanner(System.in);
        Stack<Memento> undo=new Stack<Memento>();
        Stack<Memento> redo =new Stack<Memento>();
        while (true){
            System.out.println("开始操作，1修改，2显示，3撤销，4重做");
            String str=c.next();
            switch (str){
                case "1":
                    System.out.println("请输入字符串:");
                    undo.push(t.createMemento());
                    t.resetContent(c.next());
                    break;
                case "2":
                    t.showContent();
                    break;
                case "3":
                    if(undo.empty()){
                        System.out.println("近期无改写");
                        break;
                    }
                    redo.push(t.createMemento());
                    t.restoreMemento(undo.pop());
                    break;
                case "4":
                    if(redo.empty()){
                        System.out.println("近期无撤销");
                        break;
                    }
                    undo.push(t.createMemento());
                    t.restoreMemento(redo.pop());

            }
        }
    }
}
```

```java
package menento_moudle;

public class txt {
    public String content="";
    public void showContent(){
        System.out.println("\r\n--------------\r\n"+content+"--------------\r\n");
    }

    public void resetContent(String content){
        this.content=content;
    }
    public Memento createMemento(){
        return new Memento(content);
    }
    public void restoreMemento(Memento m){
        this.content=m.getContent();
    }

}
```

运行main结果：

![image-20221026230513873](C:\Users\fatak\AppData\Roaming\Typora\typora-user-images\image-20221026230513873.png)